--[[
    CROSS-PLACE DEEP HOP
    Tujuan: Mencari server kosong di MAP TUJUAN (Map 2), 
    lalu teleport langsung ke sana dari mana saja.
]]

local Http = game:GetService("HttpService")
local TPS = game:GetService("TeleportService")
local Players = game:GetService("Players")

-- === KONFIGURASI PENTING ===
-- GANTI INI DENGAN ID MAP 2 (Tempat Boss berada)
-- Contoh: local TargetPlaceID = 1234567890
local TargetPlaceID = 129009554587176 -- <--- MASUKKAN ID MAP 2 DI SINI

print("--- MULAI PENCARIAN SERVER UNTUK MAP ID: " .. TargetPlaceID .. " ---")

local function CrossPlaceHop()
    if TargetPlaceID == 0 then
        warn("⚠️ HARAP ISI TargetPlaceID DENGAN ID MAP 2 DULU!")
        return
    end

    local cursor = ""
    local foundServer = false
    
    print("Sedang mencari server sepi di Map Sebelah...")
    
    -- Loop Deep Search (Cari sampai halaman 10)
    for i = 1, 10 do
        -- Kita request daftar server milik TARGET PLACE ID, bukan game.PlaceId saat ini
        local url = "https://games.roblox.com/v1/games/" .. TargetPlaceID .. "/servers/Public?sortOrder=Desc&limit=100"
        
        if cursor ~= "" then
            url = url .. "&cursor=" .. cursor
        end
        
        local success, result = pcall(function()
            return Http:JSONDecode(game:HttpGet(url))
        end)
        
        if success and result and result.data then
            -- Cek halaman berikutnya
            if result.nextPageCursor then
                cursor = result.nextPageCursor
            else
                if i > 1 then break end
            end
            
            for _, server in pairs(result.data) do
                -- Syarat:
                -- 1. Bukan server JobID kita saat ini (jika kita sudah di Map 2)
                -- 2. Belum penuh (playing < max - 1)
                
                if server.id ~= game.JobId and server.playing < (server.maxPlayers - 1) then
                    print("✅ Ditemukan Server Map 2!")
                    print("   ID: " .. server.id)
                    print("   Ping: " .. (server.ping or "N/A"))
                    print("   Player: " .. server.playing)
                    
                    -- TELEPORT LANGSUNG KE INSTANCE SPESIFIK DI MAP 2
                    TPS:TeleportToPlaceInstance(TargetPlaceID, server.id, Players.LocalPlayer)
                    foundServer = true
                    break
                end
            end
        end
        
        if foundServer then break end
        task.wait(0.5)
    end
    
    if not foundServer then
        print("❌ Gagal menemukan server kosong di Map 2.")
        -- Opsional: Teleport biasa ke Map 2 (Biarkan Roblox yang pilih)
        TPS:Teleport(TargetPlaceID, Players.LocalPlayer)
    end
end

-- Jalankan
CrossPlaceHop()
