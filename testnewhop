--[[
    AGGRESSIVE DEEP HOP (NO BOSS LOGIC)
    Fitur:
    1. Mencari server sampai 20 halaman (Deep Search).
    2. Menarget server dengan slot kosong (MaxPlayers - 1).
    3. Menggunakan TeleportToPlaceInstance (Paksa masuk ID tertentu).
    4. Anti-Stuck: Jika gagal, coba lagi server lain di list.
]]

local Http = game:GetService("HttpService")
local TPS = game:GetService("TeleportService")
local Players = game:GetService("Players")

local function AggressiveHop()
    print("ðŸš€ MEMULAI HOP SERVER AGRESIF (Current Map)...")
    
    local PlaceID = game.PlaceId
    local cursor = ""
    local attempts = 0
    
    -- Loop pencarian halaman (Cari server yang benar-benar fresh)
    while attempts < 20 do
        attempts = attempts + 1
        
        -- Ambil data server (Descending: Dari yang ramai ke sepi)
        -- Kenapa Descending? Karena server sepi (1 player) seringkali server ngebug.
        -- Kita cari server yang 'Hampir Penuh' tapi ada celah.
        local url = "https://games.roblox.com/v1/games/" .. PlaceID .. "/servers/Public?sortOrder=Desc&limit=100"
        
        if cursor ~= "" then
            url = url .. "&cursor=" .. cursor
        end
        
        local success, result = pcall(function()
            return Http:JSONDecode(game:HttpGet(url))
        end)
        
        if success and result and result.data then
            -- Simpan cursor untuk halaman berikutnya
            if result.nextPageCursor then
                cursor = result.nextPageCursor
            end
            
            -- Scan daftar server
            for _, server in pairs(result.data) do
                -- Syarat Mutlak:
                -- 1. BUKAN JobID kita sekarang (Penting!)
                -- 2. Slot pemain masih ada (playing < max)
                if server.id ~= game.JobId and server.playing < server.maxPlayers then
                    
                    print("ðŸŽ¯ Target Ditemukan: " .. server.id)
                    print("   Players: " .. server.playing .. "/" .. server.maxPlayers)
                    
                    -- COBA TELEPORT
                    local tpSuccess, tpErr = pcall(function()
                        TPS:TeleportToPlaceInstance(PlaceID, server.id, Players.LocalPlayer)
                    end)
                    
                    if tpSuccess then
                        print("â³ Sedang Teleport...")
                        return -- Stop fungsi, biarkan roblox teleport
                    else
                        warn("âŒ Gagal TP ke server ini, cari yang lain...")
                    end
                end
            end
        end
        
        -- Jika belum nemu di halaman ini, lanjut halaman berikutnya
        print("âš ï¸ Halaman " .. attempts .. " penuh/sama. Lanjut scan...")
        task.wait(0.5)
        
        -- Jika tidak ada halaman lagi, break
        if not cursor or cursor == "" then
            break
        end
    end
    
    print("âŒ GAGAL TOTAL: Tidak menemukan server lain setelah scan dalam.")
    -- Opsi terakhir: Rejoin biasa (Pasrah)
    TPS:Teleport(PlaceID, Players.LocalPlayer)
end

-- PANGGIL FUNGSI INI SAAT MAU HOP
AggressiveHop()
